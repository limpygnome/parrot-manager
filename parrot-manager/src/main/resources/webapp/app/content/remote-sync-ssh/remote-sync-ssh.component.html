<!--
    Heading for when opening new host
-->
<h1 *ngIf="currentMode == 'open'">
    open - remote (ssh)
</h1>
<p *ngIf="currentMode == 'open'">
    This will copy a remote database to your local filesystem and add the host as a remote-sync target. This means
    you will be able to easily keep both databases synchronized.
</p>

<!--
    Heading for when creating new host for an open database
-->
<h1 *ngIf="currentMode == 'new'">
    remote-sync - new
</h1>
<p *ngIf="currentMode == 'new'">
    This will add a new host to which your current database will be synchronized. If a different database exists,
    the two will be merged. If no database exists, the current one is uploaded.
</p>

<!--
    Heading for when editing an already existing host
-->
<h1 *ngIf="currentMode == 'edit'">
    remote-sync - edit
</h1>

<form id="openRemoteSsh" [formGroup]="openForm" (ngSubmit)="open($event)" #form="ngForm">

    <div class="form-group" [ngClass]="{ 'has-error' : form.submitted && !openForm.controls['name'].valid }">
        <label class="form-control-label" for="name">
            Name
        </label>

        <input id="name"
               formControlName="name"
               [(ngModel)]="openForm.value['name']"
               type="text"
               class="form-control"
               placeholder="The name of this remote sync configuration..."
               minlength="1" maxlength="128"
        />
    </div>

    <label class="form-control-label">
        Host
    </label>

    <div class="form-inline">
        <div class="form-group" [ngClass]="{ 'has-error' : form.submitted && !openForm.controls['host'].valid }">
            <label class="sr-only" for="host">
                Host
            </label>
            <input id="host"
                   formControlName="host"
                   [(ngModel)]="openForm.value['host']"
                   type="text"
                   class="form-control"
                   placeholder="Hostname..."
                   minlength="1" maxlength="128"
            />
        </div>
        <div class="form-group" [ngClass]="{ 'has-error' : form.submitted && !openForm.controls['port'].valid }">
            <label class="sr-only" for="port">
                Port
            </label>
            <input id="port"
                   formControlName="port"
                   [(ngModel)]="openForm.value['port']"
                   type="number"
                   class="form-control"
                   placeholder="Port..."
                   min="1" max="65535"
            />
        </div>
    </div>

    <div class="form-group">
        <label class="checkbox-inline">
            <input type="checkbox"
                   id="strictHostChecking"
                   formControlName="strictHostChecking"
                   [(ngModel)]="openForm.value['strictHostChecking']"
            />
            Strict host key checking
        </label>
    </div>

    <div class="form-group" [ngClass]="{ 'has-error' : form.submitted && !openForm.controls['user'].valid }">
        <label class="form-control-label" for="user">
            User
        </label>

        <input id="user"
               formControlName="user"
               [(ngModel)]="openForm.value['user']"
               type="text"
               class="form-control"
               placeholder="Username..."
               minlength="1" maxlength="128"
        />
    </div>

    <div class="form-group" [ngClass]="{ 'has-error' : form.submitted && !openForm.controls['userPass'].valid }">
        <label class="form-control-label" for="userPass">
            Pass
        </label>

        <input id="userPass"
               formControlName="userPass"
               [(ngModel)]="openForm.value['userPass']"
               type="password"
               class="form-control"
               placeholder="Only required for pass authentication"
               minlength="1" maxlength="128"
        />
    </div>

    <div class="form-group" [ngClass]="{ 'has-error' : form.submitted && !openForm.controls['remotePath'].valid }">
        <label class="form-label" for="remotePath">
            Remote Path
        </label>
        <input id="remotePath"
               formControlName="remotePath"
               [(ngModel)]="openForm.value['remotePath']"
               type="text"
               class="form-control"
               placeholder="The remote path to the database file..."
        />
    </div>

    <div class="form-group" *ngIf="this.currentMode == 'open'" [ngClass]="{ 'has-error' : form.submitted && !openForm.controls['destinationPath'].valid }">
        <label class="form-label" for="destinationPath">
            Destination Path
        </label>
        <div class="input-group">
            <input id="destinationPath"
                   formControlName="destinationPath"
                   [(ngModel)]="openForm.value['destinationPath']"
                   type="text"
                   class="form-control"
                   placeholder="The path of where the local instance will be saved..."
            />
            <span class="input-group-btn">
                <button class="btn btn-default form-control" type="button">
                    Choose
                </button>
            </span>
        </div>
    </div>

    <div class="panel panel-default">
        <div class="panel-body">
            <div class="form-group" [ngClass]="{ 'has-error' : form.submitted && !openForm.controls['privateKeyPath'].valid }">
                <label class="form-label" for="privateKeyPath">
                    Private Key
                </label>
                <div class="input-group">
                    <input id="privateKeyPath"
                           formControlName="privateKeyPath"
                           [(ngModel)]="openForm.value['privateKeyPath']"
                           type="text"
                           class="form-control"
                           placeholder="Only required for key file auth..."
                    />
                    <span class="input-group-btn">
                <button class="btn btn-default form-control" type="button">
                    Choose
                </button>
            </span>
                </div>
            </div>

            <div class="form-group" [ngClass]="{ 'has-error' : form.submitted && !openForm.controls['privateKeyPass'].valid }">
                <label class="form-label" for="privateKeyPass">
                    Password
                </label>
                <input id="privateKeyPass"
                       formControlName="privateKeyPass"
                       type="password"
                       class="form-control"
                       placeholder="The password for your private key..."
                />
            </div>
        </div>
    </div>

    <div class="panel panel-default">
        <div class="panel-body">
            <div class="form-group">
                <label class="form-control-label">
                    Proxy
                </label>

                <div class="form-inline">
                    <div class="form-group" [ngClass]="{ 'has-error' : form.submitted && !openForm.controls['proxyHost'].valid }">
                        <label class="sr-only" for="host">
                            Proxy Host
                        </label>
                        <input id="proxyHost"
                               formControlName="proxyHost"
                               [(ngModel)]="openForm.value['proxyHost']"
                               type="text"
                               class="form-control"
                               placeholder="Proxy hostname..."
                               minlength="1" maxlength="128"
                        />
                    </div>
                    <div class="form-group" [ngClass]="{ 'has-error' : form.submitted && !openForm.controls['proxyPort'].valid }">
                        <label class="sr-only" for="port">
                            Proxy Port
                        </label>
                        <input id="proxyPort"
                               formControlName="proxyPort"
                               [(ngModel)]="openForm.value['proxyPort']"
                               type="number"
                               class="form-control"
                               placeholder="Proxy port..."
                               min="1" max="65535"
                        />
                    </div>
                    <div class="form-group" [ngClass]="{ 'has-error' : form.submitted && !openForm.controls['proxyType'].valid }">
                        <label class="sr-only" for="port">
                            Proxy Type
                        </label>
                        <select id="proxyType"
                                formControlName="proxyType"
                                [(ngModel)]="openForm.value['proxyType']"
                                type="number"
                                class="form-control"
                                minlength="1" maxlength="5"
                        >
                            <option>None</option>
                            <option>SOCKS4</option>
                            <option>SOCKS5</option>
                            <option>HTTP</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="form-group">
        <label class="checkbox-inline">
            <input type="checkbox"
                   id="promptUserPass"
                   formControlName="promptUserPass"
                   [(ngModel)]="openForm.value['promptUserPass']"
            />
            Prompt for user password
        </label>
        <label class="checkbox-inline">
            <input type="checkbox"
                   id="promptKeyPass"
                   formControlName="promptKeyPass"
                   [(ngModel)]="openForm.value['promptKeyPass']"
            />
            Prompt for key password
        </label>
    </div>

    <div class="form-group" [ngClass]="{ 'has-error' : errorMessage != null, 'has-success' : successMessage != null }">

        <button type="submit" class="btn btn-primary">
            {{ currentMode == 'open' ? 'Open' : currentMode == 'edit' ? 'Save' : 'Add' }}
        </button>

        <button type="button" class="btn btn-default" (click)="performTest()">
            Test
        </button>

        <button type="button" class="btn btn-default" (click)="actionCancel()">
            Cancel
        </button>

        <span class="help-block">{{ errorMessage }}</span>
        <span class="help-block">{{ successMessage }}</span>

    </div>

</form>
